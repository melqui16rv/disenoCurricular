<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba de Independencia de Paginaci√≥n por Secci√≥n</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .section {
            margin: 20px 0;
            padding: 15px;
            border: 2px solid #3498db;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        
        .section h3 {
            margin-top: 0;
            color: #2c3e50;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            align-items: center;
            margin: 10px 0;
        }
        
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s;
        }
        
        .btn-primary {
            background-color: #3498db;
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-success {
            background-color: #27ae60;
            color: white;
        }
        
        .btn-warning {
            background-color: #f39c12;
            color: white;
        }
        
        select {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .state-display {
            background: #ecf0f1;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
        }
        
        .url-display {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 11px;
            word-break: break-all;
        }
        
        .test-results {
            background: #d5f3d5;
            border: 1px solid #27ae60;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #dc3545;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üß™ Prueba de Independencia de Paginaci√≥n por Secci√≥n</h1>
        <p>Esta prueba verifica que los cambios de paginaci√≥n y registros por p√°gina en una secci√≥n no afecten a las otras secciones.</p>
        
        <!-- Estado actual de los par√°metros -->
        <div class="state-display" id="currentState">
            <strong>Estado actual de par√°metros URL:</strong><br>
            <span id="stateContent">No hay par√°metros</span>
        </div>
        
        <!-- URL actual -->
        <div class="url-display" id="currentURL">
            <strong>URL actual:</strong><br>
            <span id="urlContent">-</span>
        </div>
        
        <!-- Secci√≥n Dise√±os -->
        <div class="section">
            <h3>üìö Dise√±os Curriculares</h3>
            <div class="state-display">
                P√°gina actual: <span id="pagina-disenos">1</span> |
                Registros por p√°gina: <span id="registros-disenos">10</span>
            </div>
            
            <div class="controls">
                <strong>Paginaci√≥n:</strong>
                <button class="btn btn-primary" onclick="cambiarPagina('disenos', 1)">P√°g 1</button>
                <button class="btn btn-primary" onclick="cambiarPagina('disenos', 2)">P√°g 2</button>
                <button class="btn btn-primary" onclick="cambiarPagina('disenos', 3)">P√°g 3</button>
                <button class="btn btn-primary" onclick="cambiarPagina('disenos', 5)">P√°g 5</button>
            </div>
            
            <div class="controls">
                <strong>Registros por p√°gina:</strong>
                <select onchange="cambiarRegistros('disenos', this.value)">
                    <option value="5">5 por p√°gina</option>
                    <option value="10" selected>10 por p√°gina</option>
                    <option value="25">25 por p√°gina</option>
                    <option value="50">50 por p√°gina</option>
                    <option value="100">100 por p√°gina</option>
                </select>
            </div>
        </div>
        
        <!-- Secci√≥n Competencias -->
        <div class="section">
            <h3>üéØ Competencias</h3>
            <div class="state-display">
                P√°gina actual: <span id="pagina-competencias">1</span> |
                Registros por p√°gina: <span id="registros-competencias">10</span>
            </div>
            
            <div class="controls">
                <strong>Paginaci√≥n:</strong>
                <button class="btn btn-success" onclick="cambiarPagina('competencias', 1)">P√°g 1</button>
                <button class="btn btn-success" onclick="cambiarPagina('competencias', 2)">P√°g 2</button>
                <button class="btn btn-success" onclick="cambiarPagina('competencias', 3)">P√°g 3</button>
                <button class="btn btn-success" onclick="cambiarPagina('competencias', 4)">P√°g 4</button>
            </div>
            
            <div class="controls">
                <strong>Registros por p√°gina:</strong>
                <select onchange="cambiarRegistros('competencias', this.value)">
                    <option value="5">5 por p√°gina</option>
                    <option value="10" selected>10 por p√°gina</option>
                    <option value="25">25 por p√°gina</option>
                    <option value="50">50 por p√°gina</option>
                    <option value="100">100 por p√°gina</option>
                </select>
            </div>
        </div>
        
        <!-- Secci√≥n RAPs -->
        <div class="section">
            <h3>üìù RAPs (Resultados de Aprendizaje)</h3>
            <div class="state-display">
                P√°gina actual: <span id="pagina-raps">1</span> |
                Registros por p√°gina: <span id="registros-raps">10</span>
            </div>
            
            <div class="controls">
                <strong>Paginaci√≥n:</strong>
                <button class="btn btn-warning" onclick="cambiarPagina('raps', 1)">P√°g 1</button>
                <button class="btn btn-warning" onclick="cambiarPagina('raps', 2)">P√°g 2</button>
                <button class="btn btn-warning" onclick="cambiarPagina('raps', 6)">P√°g 6</button>
                <button class="btn btn-warning" onclick="cambiarPagina('raps', 10)">P√°g 10</button>
            </div>
            
            <div class="controls">
                <strong>Registros por p√°gina:</strong>
                <select onchange="cambiarRegistros('raps', this.value)">
                    <option value="5">5 por p√°gina</option>
                    <option value="10" selected>10 por p√°gina</option>
                    <option value="25">25 por p√°gina</option>
                    <option value="50">50 por p√°gina</option>
                    <option value="100">100 por p√°gina</option>
                </select>
            </div>
        </div>
        
        <!-- Resultados de las pruebas -->
        <div class="test-results" id="testResults">
            <h3>‚úÖ Resultados de Pruebas</h3>
            <ul id="resultsList">
                <li>Haz clic en los botones arriba para probar la independencia de las secciones</li>
            </ul>
        </div>
        
        <!-- Controles de prueba autom√°tica -->
        <div class="controls">
            <button class="btn btn-primary" onclick="ejecutarPruebaCompleta()">üß™ Ejecutar Prueba Completa</button>
            <button class="btn btn-success" onclick="limpiarPruebas()">üóëÔ∏è Limpiar Resultados</button>
            <button class="btn btn-warning" onclick="resetearURL()">üîÑ Resetear URL</button>
        </div>
    </div>

    <script>
        // Estado inicial
        let estadoActual = {
            pagina_disenos: 1,
            pagina_competencias: 1,
            pagina_raps: 1,
            registros_disenos: 10,
            registros_competencias: 10,
            registros_raps: 10
        };
        
        let contadorPruebas = 0;
        
        // Funciones para manejar URLs
        function actualizarURL() {
            const baseURL = window.location.pathname;
            const params = new URLSearchParams();
            
            // Agregar par√°metros del estado actual
            Object.keys(estadoActual).forEach(key => {
                if (estadoActual[key] !== 1 && !(key.includes('registros') && estadoActual[key] === 10)) {
                    params.set(key, estadoActual[key]);
                }
            });
            
            const newURL = baseURL + (params.toString() ? '?' + params.toString() : '');
            window.history.pushState({}, '', newURL);
            
            actualizarDisplays();
        }
        
        function actualizarDisplays() {
            // Actualizar estado visual
            document.getElementById('pagina-disenos').textContent = estadoActual.pagina_disenos;
            document.getElementById('pagina-competencias').textContent = estadoActual.pagina_competencias;
            document.getElementById('pagina-raps').textContent = estadoActual.pagina_raps;
            
            document.getElementById('registros-disenos').textContent = estadoActual.registros_disenos;
            document.getElementById('registros-competencias').textContent = estadoActual.registros_competencias;
            document.getElementById('registros-raps').textContent = estadoActual.registros_raps;
            
            // Actualizar displays de estado y URL
            const estadoContent = Object.keys(estadoActual)
                .map(key => `${key}: ${estadoActual[key]}`)
                .join(', ');
            document.getElementById('stateContent').textContent = estadoContent;
            
            document.getElementById('urlContent').textContent = window.location.href;
        }
        
        function cambiarPagina(seccion, pagina) {
            const estadoAnterior = { ...estadoActual };
            estadoActual[`pagina_${seccion}`] = pagina;
            
            verificarIndependencia(seccion, 'p√°gina', pagina, estadoAnterior);
            actualizarURL();
        }
        
        function cambiarRegistros(seccion, registros) {
            const estadoAnterior = { ...estadoActual };
            estadoActual[`registros_${seccion}`] = parseInt(registros);
            estadoActual[`pagina_${seccion}`] = 1; // Reset p√°gina al cambiar registros
            
            verificarIndependencia(seccion, 'registros', registros, estadoAnterior);
            actualizarURL();
        }
        
        function verificarIndependencia(seccionCambiada, tipoCambio, valor, estadoAnterior) {
            const secciones = ['disenos', 'competencias', 'raps'];
            const resultsList = document.getElementById('resultsList');
            
            contadorPruebas++;
            
            let mensajeResultado = `Prueba ${contadorPruebas}: Cambio de ${tipoCambio} en ${seccionCambiada} a ${valor}`;
            let todosCorrecto = true;
            
            // Verificar que otras secciones no cambiaron
            secciones.forEach(seccion => {
                if (seccion !== seccionCambiada) {
                    const paginaAnterior = estadoAnterior[`pagina_${seccion}`];
                    const paginaActual = estadoActual[`pagina_${seccion}`];
                    const registrosAnterior = estadoAnterior[`registros_${seccion}`];
                    const registrosActual = estadoActual[`registros_${seccion}`];
                    
                    if (paginaAnterior !== paginaActual || registrosAnterior !== registrosActual) {
                        todosCorrecto = false;
                        mensajeResultado += ` ‚ùå FALL√ì: ${seccion} cambi√≥`;
                    }
                }
            });
            
            if (todosCorrecto) {
                mensajeResultado += ' ‚úÖ CORRECTO: otras secciones no cambiaron';
            }
            
            const li = document.createElement('li');
            li.textContent = mensajeResultado;
            li.style.color = todosCorrecto ? '#27ae60' : '#dc3545';
            li.style.fontWeight = 'bold';
            
            resultsList.appendChild(li);
            
            // Scroll al final de los resultados
            document.getElementById('testResults').scrollIntoView({ behavior: 'smooth', block: 'end' });
        }
        
        function ejecutarPruebaCompleta() {
            limpiarPruebas();
            
            // Secuencia de pruebas autom√°ticas
            setTimeout(() => cambiarPagina('disenos', 3), 500);
            setTimeout(() => cambiarRegistros('competencias', 25), 1000);
            setTimeout(() => cambiarPagina('raps', 5), 1500);
            setTimeout(() => cambiarRegistros('disenos', 50), 2000);
            setTimeout(() => cambiarPagina('competencias', 2), 2500);
            setTimeout(() => cambiarRegistros('raps', 100), 3000);
            
            setTimeout(() => {
                const li = document.createElement('li');
                li.innerHTML = '<strong>üéØ Prueba completa finalizada</strong>';
                li.style.color = '#3498db';
                document.getElementById('resultsList').appendChild(li);
            }, 3500);
        }
        
        function limpiarPruebas() {
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '<li>Resultados de pruebas aparecer√°n aqu√≠...</li>';
            contadorPruebas = 0;
        }
        
        function resetearURL() {
            estadoActual = {
                pagina_disenos: 1,
                pagina_competencias: 1,
                pagina_raps: 1,
                registros_disenos: 10,
                registros_competencias: 10,
                registros_raps: 10
            };
            
            window.history.pushState({}, '', window.location.pathname);
            actualizarDisplays();
            
            const li = document.createElement('li');
            li.innerHTML = '<strong>üîÑ Estado reseteado a valores iniciales</strong>';
            li.style.color = '#3498db';
            document.getElementById('resultsList').appendChild(li);
        }
        
        // Inicializar
        window.addEventListener('load', function() {
            actualizarDisplays();
            
            // Leer par√°metros URL si existen
            const urlParams = new URLSearchParams(window.location.search);
            Object.keys(estadoActual).forEach(key => {
                if (urlParams.has(key)) {
                    estadoActual[key] = parseInt(urlParams.get(key));
                }
            });
            
            actualizarDisplays();
        });
    </script>
</body>
</html>
